{"ast":null,"code":"import { TemplateRef } from '@angular/core';\nimport { PoDynamicFormField, PoTableColumn, PoModalComponent, PoNotificationService, PoTableAction, PoTableComponent, PoTab } from '@po-ui/ng-components';\nimport { take, finalize } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@po-ui/ng-components\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/services/produtos/produtos.service\";\nimport * as i4 from \"@angular/common\";\nconst _c0 = [\"iconTemplate\"];\n\nfunction CadProdutoComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"uppercase\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const value_r5 = ctx.$implicit;\n    i0.ɵɵclassMapInterpolate1(\"badge \", value_r5, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 4, value_r5));\n  }\n}\n\nexport let CadProdutoComponent = /*#__PURE__*/(() => {\n  class CadProdutoComponent {\n    // produtos: any;\n    constructor(poNotification, router, service) {\n      this.poNotification = poNotification;\n      this.router = router;\n      this.service = service;\n      this.showMoreDisabled = false;\n      this.produtos = {\n        Id: 0,\n        Fabricante: \"\",\n        dataCadastro: null,\n        descricao: \"\",\n        estoque: 0,\n        status: null,\n        precoVenda: null\n      };\n      this.listProdutos = [];\n      this.total = 0;\n      this.tab1 = true;\n      this.tab2 = false;\n      this.tabs = [];\n      this.nameBotao = \"Salvar\";\n      this.DisableBotaoLimpar = true;\n      this.actions = [{\n        action: this.editar.bind(this),\n        icon: 'po-icon-edit',\n        label: 'Editar'\n      }, {\n        action: this.visualizar.bind(this),\n        icon: 'po-icon-info',\n        label: 'Visualizar'\n      }, {\n        action: this.remove.bind(this),\n        icon: 'po-icon po-icon-delete',\n        label: 'Remove'\n      }];\n      this.intevalo = setInterval(() => {\n        this.items = this.getItems();\n      }, 1000);\n      this.fields = [{\n        property: \"Id\",\n        label: \"Codigo id\",\n        gridColumns: 1,\n        gridSmColumns: 6,\n        disabled: true,\n        key: true,\n        type: \"number\"\n      }, {\n        property: \"descricao\",\n        label: \"Descricao\",\n        gridColumns: 10,\n        gridSmColumns: 6,\n        icon: 'po-icon po-icon-stock'\n      }, {\n        property: \"Fabricante\",\n        label: \"Fabricante\",\n        gridColumns: 8,\n        gridSmColumns: 6,\n        icon: \"po-icon po-icon-manufacture\"\n      }, {\n        property: \"precoVenda\",\n        label: \"Preço de Venda\",\n        gridColumns: 2,\n        gridSmColumns: 6,\n        icon: \"po-icon po-icon-finance\"\n      }, {\n        property: \"estoque\",\n        label: \"Estoque\",\n        gridColumns: 1,\n        gridSmColumns: 6,\n        icon: 'po-icon po-icon-clipboard'\n      }, {\n        property: \"Status\",\n        label: \"Status\",\n        gridColumns: 4,\n        gridSmColumns: 6,\n        options: [{\n          label: 'Ativo',\n          value: 1\n        }, {\n          label: 'Inativo',\n          value: 2\n        }]\n      }];\n    }\n\n    ngOnInit() {\n      this.columns = this.getColumns();\n    }\n\n    oncLickLimpar(form) {\n      this.retoreForm();\n      this.DisableBotaoLimpar = true;\n      this.nameBotao = \"Salvar\";\n    }\n\n    onClickTab(tab) {\n      if (tab.label == \"Novo cadastro\") {\n        this.tab2 = true;\n        this.tab1 = false;\n      } else {\n        this.tab1 = true;\n        this.tab2 = false;\n      }\n    }\n\n    discount(item) {\n      if (!item.disableDiscount) {\n        const updatedItem = { ...item,\n          value: item.value - item.value * 0.2,\n          disableDiscount: true\n        };\n        this.poTable.updateItem(item, updatedItem);\n      }\n    }\n\n    visualizar(item) {\n      this.detail = item;\n      this.poModal.open();\n    }\n\n    editar(item) {\n      this.detail = item;\n      console.log(this.detail);\n      this.tab1 = false;\n      this.tab2 = true;\n      this.produtos = this.detail;\n\n      if (this.produtos.Id > 0) {\n        this.nameBotao = \"Alterar\";\n        this.DisableBotaoLimpar = false;\n      }\n    }\n\n    remove(item) {\n      this.poTable.removeItem(item);\n      this.produtos = item;\n      this.service.ExcluirProduto(this.produtos).pipe(take(1), finalize(() => {})).subscribe(x => {\n        this.poNotification.success(x[\"retorno\"]);\n      });\n    }\n\n    retoreForm() {\n      this.produtos.Id = 0;\n      this.produtos.Fabricante = \"\";\n      this.produtos.dataCadastro = null;\n      this.produtos.descricao = \"\";\n      this.produtos.estoque = 0;\n      this.produtos.status = null;\n      this.produtos.precoVenda = null;\n    }\n\n    decreaseTotal(row) {\n      if (row.value) {\n        this.total -= row.value;\n      }\n    }\n\n    getColumns() {\n      return [{\n        property: 'Id',\n        type: 'number',\n        width: '8%'\n      }, {\n        property: 'descricao',\n        label: 'Descrição'\n      }, {\n        property: 'Fabricante',\n        label: 'Fabticante'\n      }, {\n        property: 'precoVenda',\n        label: 'Preço de Venda'\n      }, {\n        property: 'dataCadastro',\n        label: 'Data Cadastro',\n        type: 'dateTime',\n        visible: true\n      }, {\n        property: 'estoque',\n        label: 'Estoque',\n        type: 'number',\n        width: '15%',\n        visible: true\n      }, {\n        property: 'status',\n        type: 'boolean',\n        width: '8%',\n        labels: [{\n          value: 'true',\n          color: 'color-11',\n          label: 'Ativo'\n        }, {\n          value: 'false',\n          color: 'color-08',\n          label: 'Inativo'\n        }]\n      }];\n    }\n\n    getItems() {\n      this.service.getAllProdutos().pipe(take(1), finalize(() => {})).subscribe(produtoList => {\n        this.listProdutos = [];\n        produtoList.forEach(dados => {\n          this.listProdutos.push({\n            Id: dados.Id,\n            descricao: dados.descricao,\n            estoque: dados.estoque,\n            precoVenda: dados.precoVenda,\n            status: dados.status,\n            Fabricante: dados.Fabricante,\n            dataCadastro: dados.dataCadastro\n          });\n        });\n        this.loading = false;\n      });\n      return this.listProdutos;\n    }\n\n    getForm(form) {\n      this.dynamicForm = form;\n      console.log(this.produtos.Id);\n\n      if (this.produtos.Id == 0 || this.produtos.Id == null) {\n        this.produtos = this.dynamicForm.form.value;\n        this.service.CreateProduto(this.produtos).pipe(take(2), finalize(() => {})).subscribe(x => {\n          this.poNotification.success(x[\"retorno\"]);\n          this.idRegister = x[\"idRegister\"];\n          this.retoreForm();\n        });\n      } else {\n        this.service.UpdadeProduto(this.produtos).pipe(take(1), finalize(() => {})).subscribe(x => {\n          this.poNotification.success(x[\"retorno\"]);\n          this.idRegister = x[\"idRegister\"];\n        });\n      }\n    }\n\n  }\n\n  CadProdutoComponent.ɵfac = function CadProdutoComponent_Factory(t) {\n    return new (t || CadProdutoComponent)(i0.ɵɵdirectiveInject(i1.PoNotificationService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ProdutosService));\n  };\n\n  CadProdutoComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CadProdutoComponent,\n    selectors: [[\"app-cad-produto\"]],\n    viewQuery: function CadProdutoComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(PoModalComponent, 7);\n        i0.ɵɵviewQuery(_c0, 7);\n        i0.ɵɵviewQuery(PoTableComponent, 7);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.poModal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.iconTemplate = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.poTable = _t.first);\n      }\n    },\n    decls: 18,\n    vars: 20,\n    consts: [[\"p-label\", \"Produtos\", 3, \"p-active\", \"p-click\"], [\"tabGrade\", \"\"], [\"p-container\", \"shadow\", 3, \"p-columns\", \"p-items\", \"p-loading\", \"p-actions\", \"p-striped\", \"p-selectable\", \"p-sort\", \"p-unselected\"], [\"p-table-column-template\", \"\", 3, \"p-property\"], [\"p-label\", \"Novo cadastro\", 3, \"p-active\", \"p-click\"], [\"tabNovoProduto\", \"\"], [\"parentForm\", \"\"], [3, \"p-fields\", \"p-value\"], [\"dynamicForm\", \"\"], [1, \"po-row\"], [1, \"po-md-3\", 3, \"p-label\", \"p-disabled\", \"p-click\"], [\"p-label\", \"Limpar/Novo\", 1, \"po-md-3\", 3, \"p-disabled\", \"p-click\"], [\"p-click-out\", \"true\", \"p-size\", \"sm\", 3, \"p-title\"], [\"p-label\", \"Estoque\", 1, \"po-sm-2\", 3, \"p-value\"], [\"p-label\", \"Data cadastro\", 1, \"po-sm-6\", 3, \"p-value\"], [\"p-label\", \"Pre\\u00E7o venda\", 1, \"po-sm-4\", 3, \"p-value\"]],\n    template: function CadProdutoComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r6 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"po-tabs\")(1, \"po-tab\", 0, 1);\n        i0.ɵɵlistener(\"p-click\", function CadProdutoComponent_Template_po_tab_p_click_1_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r0 = i0.ɵɵreference(2);\n\n          return i0.ɵɵresetView(ctx.onClickTab(_r0));\n        });\n        i0.ɵɵelementStart(3, \"po-table\", 2);\n        i0.ɵɵlistener(\"p-unselected\", function CadProdutoComponent_Template_po_table_p_unselected_3_listener($event) {\n          return ctx.decreaseTotal($event);\n        });\n        i0.ɵɵtemplate(4, CadProdutoComponent_ng_template_4_Template, 3, 6, \"ng-template\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"po-tab\", 4, 5);\n        i0.ɵɵlistener(\"p-click\", function CadProdutoComponent_Template_po_tab_p_click_5_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r2 = i0.ɵɵreference(6);\n\n          return i0.ɵɵresetView(ctx.onClickTab(_r2));\n        });\n        i0.ɵɵelementStart(7, \"form\", null, 6);\n        i0.ɵɵelement(9, \"po-dynamic-form\", 7, 8);\n        i0.ɵɵelementStart(11, \"div\", 9)(12, \"po-button\", 10);\n        i0.ɵɵlistener(\"p-click\", function CadProdutoComponent_Template_po_button_p_click_12_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r4 = i0.ɵɵreference(10);\n\n          return i0.ɵɵresetView(ctx.getForm(_r4));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"po-button\", 11);\n        i0.ɵɵlistener(\"p-click\", function CadProdutoComponent_Template_po_button_p_click_13_listener() {\n          i0.ɵɵrestoreView(_r6);\n\n          const _r4 = i0.ɵɵreference(10);\n\n          return i0.ɵɵresetView(ctx.oncLickLimpar(_r4));\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(14, \"po-modal\", 12);\n        i0.ɵɵelement(15, \"po-info\", 13)(16, \"po-info\", 14)(17, \"po-info\", 15);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r4 = i0.ɵɵreference(10);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-active\", ctx.tab1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"p-columns\", ctx.columns)(\"p-items\", ctx.items)(\"p-loading\", ctx.loading)(\"p-actions\", ctx.actions)(\"p-striped\", true)(\"p-selectable\", true)(\"p-sort\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-property\", \"component.type\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-active\", ctx.tab2);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"p-fields\", ctx.fields)(\"p-value\", ctx.produtos);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"p-label\", ctx.nameBotao)(\"p-disabled\", _r4 == null ? null : _r4.form.invalid);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-disabled\", ctx.DisableBotaoLimpar);\n        i0.ɵɵadvance(1);\n        i0.ɵɵpropertyInterpolate2(\"p-title\", \"\", ctx.detail == null ? null : ctx.detail.descricao, \" - \", ctx.detail == null ? null : ctx.detail.Fabricante, \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-value\", ctx.detail == null ? null : ctx.detail.estoque);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-value\", ctx.detail == null ? null : ctx.detail.dataCadastro);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-value\", ctx.detail == null ? null : ctx.detail.precoVenda);\n      }\n    },\n    dependencies: [i1.PoButtonComponent, i1.PoDynamicFormComponent, i1.PoInfoComponent, i1.PoModalComponent, i1.PoTableComponent, i1.PoTableColumnTemplateDirective, i1.PoTabComponent, i1.PoTabsComponent, i4.UpperCasePipe]\n  });\n  return CadProdutoComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}